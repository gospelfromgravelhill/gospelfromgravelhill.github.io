---
---

// Reset using Normalize
@use "normalize" as *;

// Site configuration
@use "config" as *;

// Import Partials
@use "partials/typography" as *;
@use "partials/mixins" as *;

// Modules
@use "modules/buttons" as *;
@use "modules/forms" as *;
@use "modules/tables" as *;
@use "modules/syntax" as *;
@use "modules/books" as *;

// Mobile up base styles
@use "breakpoints/mobileup" as *;


// For Lightbox and book pages
@use "custom" as *;


// Import media queries add more as you desire
@use "breakpoints/800up" as *;
@use "breakpoints/1200up" as *;

// If IE support is needed you can add them here or create another stylesheet for specific IE fixes


/* Search results tidy-up */
#results-container {
  margin-top: 1rem;
}
#results-container a {
  text-decoration: none;
}
#results-container a:hover {
  text-decoration: underline;
}


/* --- mobile menu icon overrides (mobile only) --- */
@media (max-width: 799px) {
  .nav-toggle {
    -webkit-tap-highlight-color: rgba(0,0,0,0);
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
    user-select: none;

    float: right;
    line-height: 1;
    margin-top: 0.5em;

    background: transparent;
    border-radius: 0;
    padding: 0;

    color: inherit;
    text-decoration: none;
    position: relative;
    right: 2rem;

    display: inline-flex;
    align-items: center;
    justify-content: center;

    &:hover { background: transparent; }

    svg { width: 28px; height: 28px; }
  }
}

/* --- hide mobile toggle on desktop --- */
@media (min-width: 800px) {
  .nav-toggle { display: none !important; }
}


/* --- pagination styles --- */
.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;   /* evenly spaced */
  margin-top: 1rem;
}

.pagination a {
  text-decoration: none;
}

/* --- Homepage Recent --- */
.home-recent { margin-top: 2rem; }
.home-recent__title { text-align: center; margin-bottom: .75rem; }
.home-recent__list {
  list-style: none; padding: 0; margin: 0;
  display: grid; gap: .5rem;
}
.home-recent__item {
  display: flex; flex-wrap: wrap; gap: .5rem;
  justify-content: center; text-align: center;
}
.home-recent__item a { text-decoration: none; }
.home-recent__item time { opacity: .7; }
.home-recent__cat { opacity: .7; }
.home-recent__more { text-align: center; margin-top: .75rem; }
.home-recent__more a { text-decoration: none; }



/* --- Recent Posts: mobile tidy-up --- */
@media (max-width: 600px) {
  .home-recent__item {
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 0.25rem; /* smaller gap between title and meta */
  }

  /* clamp long titles */
  .home-recent__item a {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    max-width: 100%;
    word-break: break-word;
    overflow-wrap: anywhere;
    hyphens: auto;
  }

  /* wrap date + category together on one line */
  .home-recent__item time,
  .home-recent__cat {
    display: inline;         /* force them inline */
    font-size: 0.9rem;
    opacity: 0.75;
    margin: 0;
  }

  /* add divider between date and category if both exist */
  .home-recent__cat::before {
    content: " • ";
    opacity: 0.6;
  }
}

/* --- Recent Page --- */
.meta {
  display: flex;
  flex-wrap: wrap;
  gap: .5rem;
  align-items: baseline;
}
.meta .cats { display: inline-flex; flex-wrap: wrap; gap: .25rem; }
.cat {
  display: inline-block;
  border: 1px solid rgba(0,0,0,.2);
  padding: 0 .45em;
  border-radius: 999px;
  font-size: .875rem;
  line-height: 1.6;
  opacity: .9;
}
.cat--primary {
  text-decoration: none;
}


/* --- Fix Recent Posts meta line (mobile only) --- */
@media (max-width: 600px) {
  .home-recent__item time,
  .home-recent__item .home-recent__cat {
    display: inline;       /* force them onto the same line */
    font-size: 0.9rem;
    opacity: 0.75;
    margin: 0;
  }

  .home-recent__item .home-recent__cat::before {
    content: " • ";
    opacity: 0.6;
  }
}


/* --- Recent Posts (mobile): title first line, date+category on second line --- */
@media (max-width: 600px) {
  .home-recent__item {
    display: grid;                  /* overrides earlier flex */
    grid-template-columns: auto auto;
    column-gap: .5rem;
    row-gap: .25rem;
    justify-content: center;
    text-align: center;
  }

  /* Title spans full width on first row, keep 2-line clamp */
  .home-recent__item > a {
    grid-column: 1 / -1;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    max-width: 100%;
    word-break: break-word;
    overflow-wrap: anywhere;
    hyphens: auto;
  }

  /* Date + category side-by-side on second row */
  .home-recent__item > time,
  .home-recent__item > .home-recent__cat {
    margin: 0;
    font-size: 0.9rem;
    opacity: 0.75;
    justify-self: center;
  }

  /* Dot between them */
  .home-recent__item > .home-recent__cat::before {
    content: " • ";
    opacity: 0.6;
  }
}


/* === Mobile sticky header (this site) === */
@media (max-width: 768px) {
  .header {
    position: sticky;
    top: 0;
    z-index: 1000;   /* stay above content */
    /* keep your existing header background image/color */
  }

  /* Keep anchors visible when using #hash links */
  main :is(h1, h2, h3, h4, h5, h6),
  .post :is(h1, h2, h3, h4, h5, h6),
  .page :is(h1, h2, h3, h4, h5, h6) {
    scroll-margin-top: 72px; /* adjust if your mobile header is taller/shorter */
  }
}


/* ---- Manual theme override hooks ---- */
html[data-theme="light"] { color-scheme: light; }
html[data-theme="dark"]  { color-scheme: dark;  }

/* Ensure strong background/text override when a manual theme is set.
   (Adjust colors if your palette differs) */
html[data-theme="dark"] body  { background:#000 !important; color:#e6e6e6 !important; }
html[data-theme="light"] body { background:#fdfdfd !important; color:#111 !important; }

/* Footer theme slider */
.footer-links .theme-toggle {
  display: flex;
  align-items: center;
  gap: .5rem;
  margin-left: .5rem;
}

.footer-links .theme-toggle .mode-label {
  font-size: .9rem;
  opacity: .8;
}

/* iOS-style 2-state switch */
.switch {
  position: relative;
  display: inline-block;
  width: 46px;
  height: 26px;
}
.switch input { display: none; }
.switch .slider {
  position: absolute; inset: 0;
  border-radius: 999px;
  background: var(--border, #e0e0e0);
  transition: background .15s ease;
}
.switch .slider::before {
  content: "";
  position: absolute; top: 3px; left: 3px;
  width: 20px; height: 20px; border-radius: 50%;
  background: var(--card, #fff);
  box-shadow: 0 1px 2px rgba(0,0,0,.15);
  transition: transform .15s ease;
}

/* Checked = Dark */
.switch input:checked + .slider {
  background: var(--link, #2e8b57);
}
.switch input:checked + .slider::before {
  transform: translateX(20px);
}

/* Optional: respect dark backgrounds for the knob in dark mode */
html[data-theme="dark"] .switch .slider::before {
  background: #0b0b0b;
}



/* Make the diagonal band/overlay follow the manual theme choice */
html[data-theme="light"] .content:after,
html[data-theme="light"] .post .featuredImage:before {
  background: #ffffff !important;
}

html[data-theme="dark"] .content:after,
html[data-theme="dark"] .post .featuredImage:before {
  background: #000000 !important;
}
